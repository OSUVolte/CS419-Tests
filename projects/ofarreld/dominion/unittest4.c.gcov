        -:    0:Source:unittest4.c
        -:    0:Graph:unittest4.gcno
        -:    0:Data:unittest4.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#include "dominion.h"
        -:    2:#include "dominion_helpers.h"
        -:    3:#include <string.h>
        -:    4:#include <stdio.h>
        -:    5:#include <assert.h>
        -:    6:#include "rngs.h"
        -:    7:#include <stdlib.h>
        -:    8:#include <math.h>
        -:    9:
        -:   10:#include "testHelper.h"
        -:   11:
        -:   12:#define TESTCARD "updateCoinst"
        -:   13:
        1:   14:int main() {
        -:   15:
        1:   16:	int newCards = 0;
        1:   17:	int discarded = 1;
        1:   18:	int newCoins = 0;
        1:   19:	int shuffledCards = 0;
        1:   20:	int bonus = 0;
        1:   21:	int seed = 1000;
        1:   22:	int numPlayers = 2;
        1:   23:	int thisPlayer = 0;
        1:   24:	int otherPlayer = 1;
        1:   25:	int a = 0;
        -:   26:
        -:   27:	struct gameState G, testG;
        1:   28:	int k[10] = {adventurer, embargo, village, minion, mine, cutpurse,
        -:   29:		sea_hag, tribute, smithy, council_room};
        -:   30:	
        1:   31:	initializeGame(numPlayers, k, seed, &G);
        -:   32:	// set hand to estates:
        1:   33:	printf("handCount: %d\n", G.handCount[thisPlayer]);
        7:   34:	while (a < 5) {
        5:   35:		G.hand[thisPlayer][a] = estate;
        5:   36:		a++;
        -:   37:	}
        1:   38:	updateCoins(thisPlayer, &G, 0);
        -:   39:
        1:   40:	printf("\t Testing Card: %s \n", TESTCARD);
        -:   41:	// boot up the perfect version
        1:   42:	memcpy(&testG, &G, sizeof(struct gameState));
        -:   43:
        -:   44:
        -:   45://int updateCoins(int player, struct gameState *state, int bonus)
        -:   46:
        -:   47:	// Test 01 -----------------------------------------------------------------
        1:   48:	linePrint();
        1:   49:	printf("Test 01: one copper to hand\n");
        1:   50:	memcpy(&testG, &G, sizeof(struct gameState));
        -:   51:
        1:   52:	newCoins = 1;
        1:   53:	testG.hand[thisPlayer][0] = copper;
        1:   54:	updateCoins(thisPlayer, &testG, 0);
        -:   55:	
        1:   56:	printf("Testing coin with one copper in hand...\t");
        1:   57:	if (testG.coins != (G.coins + newCoins)) {
    #####:   58:		printf("ERROR\n");
    #####:   59:		printf("Player coins: %d, expected: %d\n", testG.coins, (G.coins + newCoins));
        -:   60:	} else {
        1:   61:		printf("PASS\n");
        -:   62:	}
        1:   63:	genericTest(G, testG, otherPlayer, 0);
        -:   64:
        -:   65:	// Test 02 -----------------------------------------------------------------
        1:   66:	linePrint();
        1:   67:	printf("Test 02: one silver to hand\n");
        1:   68:	memcpy(&testG, &G, sizeof(struct gameState));
        -:   69:
        1:   70:	newCoins = 2;
        1:   71:	testG.hand[thisPlayer][0] = silver;
        1:   72:	updateCoins(thisPlayer, &testG, 0);
        -:   73:	
        1:   74:	printf("Testing coin with one silver in hand...\t");
        1:   75:	if (testG.coins != (G.coins + newCoins)) {
    #####:   76:		printf("ERROR\n");
    #####:   77:		printf("Player coins: %d, expected: %d\n", testG.coins, (G.coins + newCoins));
        -:   78:	} else {
        1:   79:		printf("PASS\n");
        -:   80:	}
        1:   81:	genericTest(G, testG, otherPlayer, 0);
        -:   82:
        -:   83:
        -:   84:	// Test 03 -----------------------------------------------------------------
        1:   85:	linePrint();
        1:   86:	printf("Test 03: one gold to hand\n");
        1:   87:	memcpy(&testG, &G, sizeof(struct gameState));
        -:   88:
        1:   89:	newCoins = 3;
        1:   90:	testG.hand[thisPlayer][0] = gold;
        1:   91:	updateCoins(thisPlayer, &testG, 0);
        -:   92:	
        1:   93:	printf("Testing coin with one silver in hand...\t");
        1:   94:	if (testG.coins != (G.coins + newCoins)) {
    #####:   95:		printf("ERROR\n");
    #####:   96:		printf("Player coins: %d, expected: %d\n", testG.coins, (G.coins + newCoins));
        -:   97:	} else {
        1:   98:		printf("PASS\n");
        -:   99:	}
        1:  100:	genericTest(G, testG, otherPlayer, 0);
        -:  101:
        -:  102:	// Test 04 -----------------------------------------------------------------
        1:  103:	linePrint();
        1:  104:	printf("Test 04: one gold to hand and -1 bonus\n");
        1:  105:	memcpy(&testG, &G, sizeof(struct gameState));
        -:  106:
        1:  107:	newCoins = 3;
        1:  108:	bonus = -1;
        1:  109:	testG.hand[thisPlayer][0] = gold;
        1:  110:	updateCoins(thisPlayer, &testG, bonus);
        -:  111:	
        1:  112:	printf("Testing coin with one silver in hand...\t");
        1:  113:	if (testG.coins != (G.coins + newCoins + bonus)) {
    #####:  114:		printf("ERROR\n");
    #####:  115:		printf("Player coins: %d, expected: %d\n", testG.coins, (G.coins + newCoins + bonus));
        -:  116:	} else {
        1:  117:		printf("PASS\n");
        -:  118:	}
        1:  119:	genericTest(G, testG, otherPlayer, 0);
        -:  120:
        -:  121:
        -:  122:
        -:  123:
        -:  124:
        -:  125:
        1:  126:	printf("\n >>>>> SUCCESS: Testing complete %s <<<<<\n\n", TESTCARD);
        1:  127:	return 0;
        -:  128:}
        -:  129:
        -:  130:
        -:  131:
        -:  132:
